2025-10-10 04:21:10,707 P48774 INFO Params: {
    "attention_dim": "8",
    "attention_layers": "3",
    "batch_norm": "False",
    "batch_size": "128",
    "data_format": "parquet",
    "data_root": "../../data/",
    "dataset_id": "train_parquet",
    "debug_mode": "False",
    "dnn_activations": "relu",
    "dnn_hidden_units": "[64, 32]",
    "early_stop_patience": "2",
    "embedding_dim": "4",
    "embedding_regularizer": "1e-08",
    "epochs": "1",
    "eval_steps": "None",
    "feature_config": "None",
    "feature_specs": "None",
    "gpu": "0",
    "group_id": "None",
    "layer_norm": "False",
    "learning_rate": "0.001",
    "loss": "binary_crossentropy",
    "metrics": "['logloss', 'AUC']",
    "model": "Baseline_SA",
    "model_id": "Baseline_SA_test",
    "model_root": "./checkpoints/",
    "monitor": "AUC",
    "monitor_mode": "max",
    "net_dropout": "0",
    "net_regularizer": "0",
    "num_heads": "2",
    "num_workers": "3",
    "optimizer": "adam",
    "pickle_feature_encoder": "True",
    "save_best_only": "True",
    "seed": "2019",
    "shuffle": "True",
    "task": "binary_classification",
    "test_data": "../../data/test.parquet",
    "train_data": "../../data/train.parquet",
    "use_features": "None",
    "use_residual": "True",
    "use_scale": "False",
    "use_wide": "False",
    "valid_data": "../../data/valid.parquet",
    "verbose": "1"
}
2025-10-10 04:21:10,707 P48774 INFO Load feature_map from json: ../../data/train_parquet/feature_map.json
2025-10-10 04:21:10,708 P48774 INFO Set column index...
2025-10-10 04:21:10,708 P48774 INFO Feature specs: {
    "age_group": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "day_of_week": "{'source': 'context', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "feat_a_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 15, 'vocab_size': 16}",
    "feat_a_10": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 77, 'vocab_size': 78}",
    "feat_a_11": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 38, 'vocab_size': 39}",
    "feat_a_12": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 15, 'vocab_size': 16}",
    "feat_a_13": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 48, 'vocab_size': 49}",
    "feat_a_14": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "feat_a_15": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 63, 'vocab_size': 64}",
    "feat_a_16": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20}",
    "feat_a_17": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 4, 'vocab_size': 5}",
    "feat_a_18": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 48, 'vocab_size': 49}",
    "feat_a_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 5, 'vocab_size': 6}",
    "feat_a_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 31, 'vocab_size': 32}",
    "feat_a_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 89, 'vocab_size': 90}",
    "feat_a_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 87, 'vocab_size': 88}",
    "feat_a_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 18, 'vocab_size': 19}",
    "feat_a_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 37, 'vocab_size': 38}",
    "feat_a_8": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 64, 'vocab_size': 65}",
    "feat_a_9": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 91, 'vocab_size': 92}",
    "feat_b_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2067, 'vocab_size': 2068}",
    "feat_b_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_b_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1173, 'vocab_size': 1174}",
    "feat_b_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2, 'vocab_size': 3}",
    "feat_b_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_b_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 86992, 'vocab_size': 86993}",
    "feat_c_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 59, 'vocab_size': 60}",
    "feat_c_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 36, 'vocab_size': 37}",
    "feat_c_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 84, 'vocab_size': 85}",
    "feat_c_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 30, 'vocab_size': 31}",
    "feat_c_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 48, 'vocab_size': 49}",
    "feat_c_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 9, 'vocab_size': 10}",
    "feat_c_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 75, 'vocab_size': 76}",
    "feat_c_8": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 33, 'vocab_size': 34}",
    "feat_d_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_d_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "feat_d_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2, 'vocab_size': 3}",
    "feat_d_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 79, 'vocab_size': 80}",
    "feat_d_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_d_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 66, 'vocab_size': 67}",
    "feat_e_10": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 18074, 'vocab_size': 18075}",
    "feat_e_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 171, 'vocab_size': 172}",
    "feat_e_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1278, 'vocab_size': 1279}",
    "feat_e_8": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "feat_e_9": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "gender": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "history_a_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20}",
    "history_a_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_a_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 21, 'vocab_size': 22}",
    "history_a_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_a_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_a_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_a_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_b_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 42, 'vocab_size': 43}",
    "history_b_10": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20}",
    "history_b_11": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 47, 'vocab_size': 48}",
    "history_b_12": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 5, 'vocab_size': 6}",
    "history_b_13": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20}",
    "history_b_14": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 38, 'vocab_size': 39}",
    "history_b_15": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1, 'vocab_size': 2}",
    "history_b_16": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 47, 'vocab_size': 48}",
    "history_b_17": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 11, 'vocab_size': 12}",
    "history_b_18": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "history_b_19": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 7, 'vocab_size': 8}",
    "history_b_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 90, 'vocab_size': 91}",
    "history_b_20": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2, 'vocab_size': 3}",
    "history_b_21": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6, 'vocab_size': 7}",
    "history_b_22": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 46, 'vocab_size': 47}",
    "history_b_23": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 46, 'vocab_size': 47}",
    "history_b_24": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 8, 'vocab_size': 9}",
    "history_b_25": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 4, 'vocab_size': 5}",
    "history_b_26": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 29, 'vocab_size': 30}",
    "history_b_27": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 33, 'vocab_size': 34}",
    "history_b_28": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 11, 'vocab_size': 12}",
    "history_b_29": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 27, 'vocab_size': 28}",
    "history_b_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 31, 'vocab_size': 32}",
    "history_b_30": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 34, 'vocab_size': 35}",
    "history_b_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 33, 'vocab_size': 34}",
    "history_b_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 18, 'vocab_size': 19}",
    "history_b_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2, 'vocab_size': 3}",
    "history_b_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 17, 'vocab_size': 18}",
    "history_b_8": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 34, 'vocab_size': 35}",
    "history_b_9": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 4, 'vocab_size': 5}",
    "hour": "{'source': 'context', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 24, 'vocab_size': 25}",
    "inventory_id": "{'source': 'context', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 96, 'vocab_size': 97}",
    "l_feat_1": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_10": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 263, 'vocab_size': 264}",
    "l_feat_11": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1528, 'vocab_size': 1529}",
    "l_feat_12": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 5062, 'vocab_size': 5063}",
    "l_feat_13": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_14": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3246, 'vocab_size': 3247}",
    "l_feat_15": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2591, 'vocab_size': 2592}",
    "l_feat_16": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_17": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 477, 'vocab_size': 478}",
    "l_feat_18": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 7, 'vocab_size': 8}",
    "l_feat_19": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_2": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_20": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_21": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_22": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_23": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2, 'vocab_size': 3}",
    "l_feat_24": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_25": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 2164, 'vocab_size': 2165}",
    "l_feat_26": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 19, 'vocab_size': 20}",
    "l_feat_27": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 6, 'vocab_size': 7}",
    "l_feat_3": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 4, 'vocab_size': 5}",
    "l_feat_4": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 27, 'vocab_size': 28}",
    "l_feat_5": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 1080, 'vocab_size': 1081}",
    "l_feat_6": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 904, 'vocab_size': 905}",
    "l_feat_7": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 314, 'vocab_size': 315}",
    "l_feat_8": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 3, 'vocab_size': 4}",
    "l_feat_9": "{'source': '', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 477, 'vocab_size': 478}",
    "seq": "{'source': 'user', 'type': 'categorical', 'padding_idx': 0, 'oov_idx': 548, 'vocab_size': 549}"
}
2025-10-10 04:21:11,372 P48774 INFO Total number of parameters: 556930.
2025-10-10 04:21:11,372 P48774 INFO Loading data...
2025-10-10 04:21:11,372 P48774 INFO Loading parquet file: ../../data/train.parquet
2025-10-10 04:22:06,115 P48774 INFO Train samples: total/9633761, blocks/1
2025-10-10 04:22:06,115 P48774 INFO Loading parquet file: ../../data/valid.parquet
2025-10-10 04:22:13,346 P48774 INFO Validation samples: total/1070418, blocks/1
2025-10-10 04:22:13,346 P48774 INFO Loading train and validation data done.
2025-10-10 04:22:13,347 P48774 INFO Start training: 75264 batches/epoch
2025-10-10 04:22:13,347 P48774 INFO ************ Epoch=1 start ************
2025-10-10 04:43:45,993 P48774 INFO Train loss: 0.089062
2025-10-10 04:43:45,993 P48774 INFO Evaluation @epoch 1 - batch 75264: 
2025-10-10 04:44:09,937 P48774 INFO [Metrics] AUC: 0.708059
2025-10-10 04:44:09,937 P48774 INFO Save best model: monitor(max)=0.708059
2025-10-10 04:44:10,345 P48774 INFO ************ Epoch=1 end ************
2025-10-10 04:44:10,345 P48774 INFO Training finished.
2025-10-10 04:44:10,345 P48774 INFO Load best model: /home/lim/project/RE-SORT/SOTAS/Baseline_SA/checkpoints/train_parquet/Baseline_SA_test.model
2025-10-10 04:44:10,353 P48774 INFO ****** Validation evaluation ******
2025-10-10 04:44:34,283 P48774 INFO [Metrics] logloss: 0.088947 - AUC: 0.708059
2025-10-10 04:44:34,377 P48774 INFO ******** Test evaluation ********
2025-10-10 04:44:34,377 P48774 INFO Loading data...
2025-10-10 04:44:34,377 P48774 INFO Loading parquet file: ../../data/test.parquet
2025-10-10 04:44:43,104 P48774 WARNING Column clicked not found in parquet file
2025-10-10 04:44:44,508 P48774 INFO Test samples: total/1527298, blocks/1
2025-10-10 04:44:44,508 P48774 INFO Loading test data done.
