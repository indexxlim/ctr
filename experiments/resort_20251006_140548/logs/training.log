2025-10-06 14:05:48,538 - INFO - Starting CTR model training...
2025-10-06 14:05:48,538 - INFO - Model type: resort
2025-10-06 14:05:48,538 - INFO - Loss configuration: Focal Loss=False, Label Smoothing=0.0
2025-10-06 14:05:55,413 - INFO - Data loaded - Train: 9633761, Val: 1070418
2025-10-06 14:05:55,552 - INFO - Using device: cuda
2025-10-06 14:05:55,671 - INFO - Using RE-SORT model
2025-10-06 14:05:56,589 - INFO - Model compiled with torch.compile for faster training
2025-10-06 14:05:56,589 - INFO - Model created with 34078 parameters
2025-10-06 14:05:56,589 - INFO - Mixed Precision Training: Enabled
2025-10-06 14:05:56,591 - INFO - SWA will start from epoch 15/20
2025-10-06 14:05:56,591 - INFO - Starting training loop...
2025-10-06 14:09:42,109 - INFO - Epoch 1/20:
2025-10-06 14:09:42,109 - INFO -   Train Loss: 0.1669
2025-10-06 14:09:42,109 - INFO -   Val Loss: 0.0926
2025-10-06 14:09:42,109 - INFO -   Val AUC: 0.6479
2025-10-06 14:09:42,109 - INFO -   Val LogLoss: 0.0926
2025-10-06 14:09:42,109 - INFO -   Learning Rate: 0.003000
2025-10-06 14:09:42,109 - INFO -   Epoch Time: 225.52s
2025-10-06 14:09:42,109 - INFO -   ETA: 71.4 minutes (4285s)
2025-10-06 14:09:42,113 - INFO -   New best model saved at epoch 1!
2025-10-06 14:09:42,113 - INFO -   Checkpoint: checkpoint_epoch1_auc0.6479_logloss0.0926.pth
2025-10-06 14:13:26,179 - INFO - Epoch 2/20:
2025-10-06 14:13:26,179 - INFO -   Train Loss: 0.0916
2025-10-06 14:13:26,179 - INFO -   Val Loss: 0.0926
2025-10-06 14:13:26,179 - INFO -   Val AUC: 0.6488
2025-10-06 14:13:26,179 - INFO -   Val LogLoss: 0.0926
2025-10-06 14:13:26,179 - INFO -   Learning Rate: 0.002714
2025-10-06 14:13:26,179 - INFO -   Epoch Time: 224.07s
2025-10-06 14:13:26,179 - INFO -   ETA: 67.4 minutes (4046s)
2025-10-06 14:13:26,183 - INFO -   New best model saved at epoch 2!
2025-10-06 14:13:26,183 - INFO -   Checkpoint: checkpoint_epoch2_auc0.6488_logloss0.0926.pth
2025-10-06 14:17:10,821 - INFO - Epoch 3/20:
2025-10-06 14:17:10,821 - INFO -   Train Loss: 0.0915
2025-10-06 14:17:10,821 - INFO -   Val Loss: 0.0925
2025-10-06 14:17:10,821 - INFO -   Val AUC: 0.6520
2025-10-06 14:17:10,821 - INFO -   Val LogLoss: 0.0925
2025-10-06 14:17:10,821 - INFO -   Learning Rate: 0.001964
2025-10-06 14:17:10,821 - INFO -   Epoch Time: 224.64s
2025-10-06 14:17:10,821 - INFO -   ETA: 63.7 minutes (3821s)
2025-10-06 14:17:10,824 - INFO -   New best model saved at epoch 3!
2025-10-06 14:17:10,824 - INFO -   Checkpoint: checkpoint_epoch3_auc0.6520_logloss0.0925.pth
2025-10-06 14:20:55,426 - INFO - Epoch 4/20:
2025-10-06 14:20:55,426 - INFO -   Train Loss: 0.0914
2025-10-06 14:20:55,426 - INFO -   Val Loss: 0.0924
2025-10-06 14:20:55,426 - INFO -   Val AUC: 0.6522
2025-10-06 14:20:55,426 - INFO -   Val LogLoss: 0.0924
2025-10-06 14:20:55,426 - INFO -   Learning Rate: 0.001037
2025-10-06 14:20:55,426 - INFO -   Epoch Time: 224.60s
2025-10-06 14:20:55,426 - INFO -   ETA: 59.9 minutes (3595s)
2025-10-06 14:20:55,430 - INFO -   New best model saved at epoch 4!
2025-10-06 14:20:55,430 - INFO -   Checkpoint: checkpoint_epoch4_auc0.6522_logloss0.0924.pth
2025-10-06 14:24:41,197 - INFO - Epoch 5/20:
2025-10-06 14:24:41,197 - INFO -   Train Loss: 0.0914
2025-10-06 14:24:41,197 - INFO -   Val Loss: 0.0924
2025-10-06 14:24:41,197 - INFO -   Val AUC: 0.6529
2025-10-06 14:24:41,197 - INFO -   Val LogLoss: 0.0924
2025-10-06 14:24:41,197 - INFO -   Learning Rate: 0.000287
2025-10-06 14:24:41,197 - INFO -   Epoch Time: 225.77s
2025-10-06 14:24:41,197 - INFO -   ETA: 56.2 minutes (3374s)
2025-10-06 14:24:41,200 - INFO -   New best model saved at epoch 5!
2025-10-06 14:24:41,200 - INFO -   Checkpoint: checkpoint_epoch5_auc0.6529_logloss0.0924.pth
2025-10-06 14:28:24,799 - INFO - Epoch 6/20:
2025-10-06 14:28:24,800 - INFO -   Train Loss: 0.0916
2025-10-06 14:28:24,800 - INFO -   Val Loss: 0.0926
2025-10-06 14:28:24,800 - INFO -   Val AUC: 0.6501
2025-10-06 14:28:24,800 - INFO -   Val LogLoss: 0.0927
2025-10-06 14:28:24,800 - INFO -   Learning Rate: 0.003000
2025-10-06 14:28:24,800 - INFO -   Epoch Time: 223.60s
2025-10-06 14:28:24,800 - INFO -   ETA: 52.4 minutes (3146s)
2025-10-06 14:28:24,800 - INFO -   No improvement. Patience: 1/5
2025-10-06 14:32:09,634 - INFO - Epoch 7/20:
2025-10-06 14:32:09,635 - INFO -   Train Loss: 0.0915
2025-10-06 14:32:09,635 - INFO -   Val Loss: 0.0925
2025-10-06 14:32:09,635 - INFO -   Val AUC: 0.6519
2025-10-06 14:32:09,635 - INFO -   Val LogLoss: 0.0925
2025-10-06 14:32:09,635 - INFO -   Learning Rate: 0.002927
2025-10-06 14:32:09,635 - INFO -   Epoch Time: 224.83s
2025-10-06 14:32:09,635 - INFO -   ETA: 48.7 minutes (2921s)
2025-10-06 14:32:09,635 - INFO -   No improvement. Patience: 2/5
2025-10-06 14:35:53,303 - INFO - Epoch 8/20:
2025-10-06 14:35:53,303 - INFO -   Train Loss: 0.0915
2025-10-06 14:35:53,303 - INFO -   Val Loss: 0.0924
2025-10-06 14:35:53,303 - INFO -   Val AUC: 0.6516
2025-10-06 14:35:53,303 - INFO -   Val LogLoss: 0.0924
2025-10-06 14:35:53,303 - INFO -   Learning Rate: 0.002714
2025-10-06 14:35:53,303 - INFO -   Epoch Time: 223.67s
2025-10-06 14:35:53,303 - INFO -   ETA: 44.9 minutes (2695s)
2025-10-06 14:35:53,303 - INFO -   No improvement. Patience: 3/5
2025-10-06 14:39:40,076 - INFO - Epoch 9/20:
2025-10-06 14:39:40,076 - INFO -   Train Loss: 0.0914
2025-10-06 14:39:40,076 - INFO -   Val Loss: 0.0925
2025-10-06 14:39:40,076 - INFO -   Val AUC: 0.6518
2025-10-06 14:39:40,076 - INFO -   Val LogLoss: 0.0925
2025-10-06 14:39:40,076 - INFO -   Learning Rate: 0.002382
2025-10-06 14:39:40,076 - INFO -   Epoch Time: 226.77s
2025-10-06 14:39:40,076 - INFO -   ETA: 41.2 minutes (2473s)
2025-10-06 14:39:40,076 - INFO -   No improvement. Patience: 4/5
2025-10-06 14:43:27,009 - INFO - Epoch 10/20:
2025-10-06 14:43:27,010 - INFO -   Train Loss: 0.0914
2025-10-06 14:43:27,010 - INFO -   Val Loss: 0.0925
2025-10-06 14:43:27,010 - INFO -   Val AUC: 0.6522
2025-10-06 14:43:27,010 - INFO -   Val LogLoss: 0.0925
2025-10-06 14:43:27,010 - INFO -   Learning Rate: 0.001964
2025-10-06 14:43:27,010 - INFO -   Epoch Time: 226.93s
2025-10-06 14:43:27,010 - INFO -   ETA: 37.5 minutes (2250s)
2025-10-06 14:43:27,010 - INFO -   No improvement. Patience: 5/5
2025-10-06 14:43:27,010 - INFO - Early stopping triggered after 10 epochs!
2025-10-06 14:43:27,010 - INFO - Best validation loss: 0.0924 at epoch 5
2025-10-06 14:43:27,010 - INFO - Updating SWA BatchNorm statistics...
2025-10-06 14:43:27,010 - INFO - Evaluating SWA model on validation set...
2025-10-06 14:43:50,445 - INFO - SWA Model Performance:
2025-10-06 14:43:50,445 - INFO -   Val Loss: 4.1727
2025-10-06 14:43:50,445 - INFO -   Val AUC: 0.5099
2025-10-06 14:43:50,445 - INFO -   Val LogLoss: 1.8387
2025-10-06 14:43:50,445 - INFO - Best checkpoint still better than SWA model.
2025-10-06 14:43:50,445 - INFO - Starting model evaluation...
2025-10-06 14:43:50,445 - INFO - Loading model from: ./experiments/resort_20251006_140548/models/best_model_checkpoint.pth
2025-10-06 14:44:14,003 - INFO - ==================================================
2025-10-06 14:44:14,003 - INFO - EVALUATION RESULTS:
2025-10-06 14:44:14,003 - INFO - CTR AUC: 0.6529
2025-10-06 14:44:14,003 - INFO - CTR LogLoss: 0.0924
2025-10-06 14:44:14,003 - INFO - Brier Score: 0.0188
2025-10-06 14:44:14,003 - INFO - Expected Calibration Error (ECE): 0.0113
2025-10-06 14:44:14,003 - INFO - Maximum Calibration Error (MCE): 0.0220
2025-10-06 14:44:14,003 - INFO - Calibration Gap: 0.0006
2025-10-06 14:44:14,003 - INFO - Mean Predicted Prob: 0.0187
2025-10-06 14:44:14,003 - INFO - Mean Actual Prob: 0.0193
2025-10-06 14:44:14,003 - INFO - Test Samples: 1070418
2025-10-06 14:44:14,003 - INFO - ==================================================
2025-10-06 14:44:14,014 - INFO - All training artifacts saved to: ./experiments/resort_20251006_140548
2025-10-06 14:44:14,014 - INFO - Performance-based model saved to: ./saved_models/model_auc0.6529_logloss0.0924_epoch5_20251006_144414.pth
2025-10-06 14:44:14,014 - INFO - Training completed successfully!
2025-10-06 14:44:14,014 - INFO - All results saved to: ./experiments/resort_20251006_140548
