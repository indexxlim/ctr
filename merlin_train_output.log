âœ… Environment configured
âœ… All libraries imported successfully
ğŸ“‹ Configuration:
   Train: /home/lim/project/data/train.parquet
   Test: /home/lim/project/data/test.parquet
   Output: /home/lim/project/data/cudf_processed
   Submission: submission_xgboost_cudf_20251010_040222.csv
   Folds: 5
   Skip CV: False
âœ… Metric functions defined

======================================================================
ğŸ“‚ STEP 1: Process Training Data
======================================================================

======================================================================
ğŸš€ cuDF Data Processing
======================================================================
ğŸ’¾ CPU: 35.3GB/62.4GB (56.6%)
ğŸ’¾ GPU: 1.9GB/31.8GB

ğŸ“¦ Loading data...
   Total columns: 119
   Using columns: 118 (excluded 'seq')
   Loaded 10,704,179 rows
ğŸ’¾ CPU: 35.7GB/62.4GB (57.1%)
ğŸ’¾ GPU: 7.5GB/31.8GB

ğŸ“Š Feature types:
   Categorical: 5 columns
   Continuous: 112 columns

ğŸ”§ Processing categorical features...
ğŸ”§ Processing continuous features...
ğŸ’¾ CPU: 35.8GB/62.4GB (57.4%)
ğŸ’¾ GPU: 7.2GB/31.8GB

âœ… Processing complete!
   Time: 1.4s
   Memory increase: +0.8%

======================================================================
ğŸ“‚ STEP 2: Cross-Validation
======================================================================

======================================================================
ğŸ”„ Stratified KFold Cross-Validation
======================================================================
ğŸ’¾ CPU: 35.8GB/62.4GB (57.4%)
ğŸ’¾ GPU: 7.2GB/31.8GB

ğŸ“Š Preparing data for XGBoost...
   Shape: (10704179, 117)
   Features: 117
   Samples: 10,704,179

ğŸ“Š Class distribution:
   Positive ratio: 0.0191
   Scale pos weight: 51.43
ğŸ§¹ GPU memory cleared

ğŸ”„ Starting cross-validation...

ğŸ“ Fold 1/5
   Train: 8,563,343 | Val: 2,140,836
   Training...
[0]	val-logloss:0.67930
[50]	val-logloss:0.58478
[100]	val-logloss:0.57344
[150]	val-logloss:0.56496
[199]	val-logloss:0.55737
   ğŸ“Š Results:
      Score: 0.353414
      AP: 0.081542
      WLL: 0.599266
      Best iteration: 199
   â±ï¸ Time: 18.3s
ğŸ§¹ GPU memory cleared

ğŸ“ Fold 2/5
   Train: 8,563,343 | Val: 2,140,836
   Training...
[0]	val-logloss:0.67925
[50]	val-logloss:0.58482
[100]	val-logloss:0.57335
[150]	val-logloss:0.56465
[199]	val-logloss:0.55700
   ğŸ“Š Results:
      Score: 0.352969
      AP: 0.080761
      WLL: 0.599546
      Best iteration: 199
   â±ï¸ Time: 17.0s
ğŸ§¹ GPU memory cleared

ğŸ“ Fold 3/5
   Train: 8,563,343 | Val: 2,140,836
   Training...
[0]	val-logloss:0.67914
[50]	val-logloss:0.58465
[100]	val-logloss:0.57268
[150]	val-logloss:0.56377
[199]	val-logloss:0.55618
   ğŸ“Š Results:
      Score: 0.352537
      AP: 0.079933
      WLL: 0.599641
      Best iteration: 199
   â±ï¸ Time: 16.9s
ğŸ§¹ GPU memory cleared

ğŸ“ Fold 4/5
   Train: 8,563,343 | Val: 2,140,836
   Training...
[0]	val-logloss:0.67923
[50]	val-logloss:0.58454
[100]	val-logloss:0.57327
[150]	val-logloss:0.56501
[199]	val-logloss:0.55732
   ğŸ“Š Results:
      Score: 0.353752
      AP: 0.082149
      WLL: 0.599095
      Best iteration: 199
   â±ï¸ Time: 16.4s
ğŸ§¹ GPU memory cleared

ğŸ“ Fold 5/5
   Train: 8,563,344 | Val: 2,140,835
   Training...
[0]	val-logloss:0.67922
[50]	val-logloss:0.58457
[100]	val-logloss:0.57257
[150]	val-logloss:0.56371
[199]	val-logloss:0.55628
   ğŸ“Š Results:
      Score: 0.353271
      AP: 0.081344
      WLL: 0.599495
      Best iteration: 199
   â±ï¸ Time: 23.2s
ğŸ§¹ GPU memory cleared

======================================================================
ğŸ“Š Final Cross-Validation Results
======================================================================

ğŸ† Competition Score: 0.353188 Â± 0.000412
ğŸ“ˆ Average Precision: 0.081146 Â± 0.000751
ğŸ“‰ Weighted LogLoss: 0.599409 Â± 0.000200

All fold scores: ['0.353414', '0.352969', '0.352537', '0.353752', '0.353271']

âœ… CV Score: 0.353188 Â± 0.000412

======================================================================
ğŸš€ cuDF Data Processing
======================================================================
ğŸ’¾ CPU: 32.5GB/62.4GB (52.0%)
ğŸ’¾ GPU: 7.3GB/31.8GB

ğŸ“¦ Loading data...
   Total columns: 119
   Using columns: 118 (excluded 'seq')
   Loaded 10,704,179 rows
ğŸ’¾ CPU: 32.7GB/62.4GB (52.4%)
ğŸ’¾ GPU: 12.4GB/31.8GB

ğŸ“Š Feature types:
   Categorical: 5 columns
   Continuous: 112 columns

ğŸ”§ Processing categorical features...
ğŸ”§ Processing continuous features...
ğŸ’¾ CPU: 33.0GB/62.4GB (52.9%)
ğŸ’¾ GPU: 12.1GB/31.8GB

âœ… Processing complete!
   Time: 0.5s
   Memory increase: +0.9%

======================================================================
ğŸ“‚ STEP 3: Process Test Data
======================================================================

======================================================================
ğŸš€ cuDF Test Data Processing
======================================================================
ğŸ’¾ CPU: 33.0GB/62.4GB (52.9%)
ğŸ’¾ GPU: 7.3GB/31.8GB

ğŸ“¦ Loading test data...
   Total columns: 119
   Using columns: 118
   Loaded 1,527,298 rows
ğŸ’¾ CPU: 34.1GB/62.4GB (54.7%)
ğŸ’¾ GPU: 8.0GB/31.8GB

ğŸ”§ Processing categorical features...
ğŸ”§ Processing continuous features...
ğŸ’¾ CPU: 34.1GB/62.4GB (54.6%)
ğŸ’¾ GPU: 7.9GB/31.8GB

âœ… Test data processing complete!
   Time: 0.7s
   Memory increase: +1.7%

======================================================================
ğŸ“‚ STEP 4: Train Full Model & Generate Submission
======================================================================

======================================================================
ğŸ¯ Training on Full Dataset & Predicting on Test
======================================================================
ğŸ’¾ CPU: 34.1GB/62.4GB (54.6%)
ğŸ’¾ GPU: 7.9GB/31.8GB

ğŸ“Š Preparing training data...
   Train shape: (10704179, 117)
   Features: 117

ğŸ“Š Preparing test data...
   Test shape: (1527298, 117)

ğŸ“Š Class distribution:
   Positive ratio: 0.0191
   Scale pos weight: 51.43
ğŸ§¹ GPU memory cleared

ğŸš€ Training on full dataset...
   Training for 200 rounds...
   â±ï¸ Training time: 17.3s

ğŸ”® Predicting on test data...
   â±ï¸ Prediction time: 0.2s
   Predictions: min=0.003043, max=0.989592, mean=0.359432

ğŸ’¾ Creating submission file...
   âœ… Saved to: submission_xgboost_cudf_20251010_040222.csv
   Rows: 1,527,298
ğŸ§¹ GPU memory cleared

ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰
COMPLETE!
ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰ğŸ‰

âœ… Final CV Score: 0.353188 Â± 0.000412
âœ… Submission saved to: submission_xgboost_cudf_20251010_040222.csv
âœ… Total predictions: 1,527,298
âœ… Full dataset processed
âœ… cuDF-based preprocessing (CUDA 12 compatible)
======================================================================
ğŸ§¹ GPU memory cleared

ğŸ§¹ Final cleanup complete
ğŸ’¾ CPU: 34.1GB/62.4GB (54.6%)
ğŸ’¾ GPU: 8.1GB/31.8GB
